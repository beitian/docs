du值 != df值 ?
===

man 
---

   指令   | df                       | du
 ---------|--------------------------|----------------
   定义   |文件系统的磁盘使用情况报告|估算文件空间使用


问题
---
一般来说 `df` 和 `du`的结果会大致相等，但有时会发现这两者的值差距过大，这时通过 `lsof |grep -i deleted` 可看到一些被删除的文件仍在被某些程序使用。这种现象出现的原因是在 rm 或 mv 这些文件后，仍有进程在访问这些文件，因此实际上这些文件的文件句柄一直没有被释放。即 rm 和 mv 只是删除了这些文件在磁盘中的标记，其占用的磁盘空间没有得到释放，直至所有访问这些文件的进程退出为止。`du` 在统计磁盘文件大小的时候，由于文件标记被删除，不会计算这些“被删文件”的空间可以测试下，即使新建这些“被删除文件”，仍然没有任何数据的读写，除非重启程序。

解决方法
---

真正的删除这些被使用的文件，通常的解决方法有如下两种：

- 关闭或重启占用文件的相关进程  
在 `lsof | grep deleted`的结果中，可以看到占用这些文件的进程PID。在`ps axuf |grep PID`后，重启或者关闭这些进程后，空间会被释放。

- 清空文件  
直接以`> filename`方式的清空会提示文件不存在。需要以`>/proc/PID/fd/FD号`的方式清空。

eg:

    $ lsof | grep deleted
    #        PID           FD号   TYPE   磁盘名称    文件大小     NODE       文件名  
    $ java  30512  evans   85r    REG     8,3      7407144    1870053   /home/www/log/access.log (deleted)
    $ >/proc/30512/fd/85

如果这些文件是被误删除，要恢复这些文件，只需将`/proc/PID/fd/FD号`重定向到某个文件即可，如下：

    $ cat /proc/30512/fd/85 > /home/www/log/access.log


